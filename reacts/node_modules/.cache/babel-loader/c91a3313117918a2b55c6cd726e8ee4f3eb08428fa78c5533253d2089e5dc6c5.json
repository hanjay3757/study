{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState } from 'react';\n\n// ... existing code ...\n\nfunction Battle({\n  playerParty,\n  enemyParty\n}) {\n  _s();\n  // ... existing state declarations ...\n\n  // State 선언 추가\n  const [battleLog, setBattleLog] = useState([]);\n  const [currentTurn, setCurrentTurn] = useState(1);\n  const [isBattling, setIsBattling] = useState(false);\n\n  // 카드의 스탯 계산 함수 수정 - 더 균형잡힌 스탯\n  const getCardStats = card => {\n    const baseStats = {\n      SSR: {\n        hp: 100,\n        atk: 20,\n        def: 15\n      },\n      SR: {\n        hp: 85,\n        atk: 17,\n        def: 13\n      },\n      S: {\n        hp: 70,\n        atk: 15,\n        def: 11\n      },\n      R: {\n        hp: 60,\n        atk: 13,\n        def: 9\n      },\n      H: {\n        hp: 50,\n        atk: 11,\n        def: 7\n      },\n      N: {\n        hp: 40,\n        atk: 9,\n        def: 5\n      }\n    };\n    const jobMultipliers = {\n      전사: {\n        hp: 1.2,\n        atk: 0.9,\n        def: 1.3\n      },\n      마법사: {\n        hp: 0.8,\n        atk: 1.4,\n        def: 0.7\n      },\n      궁수: {\n        hp: 0.9,\n        atk: 1.2,\n        def: 0.8\n      },\n      도적: {\n        hp: 0.7,\n        atk: 1.3,\n        def: 0.6\n      },\n      사제: {\n        hp: 1.1,\n        atk: 0.7,\n        def: 1.0\n      }\n    };\n    const base = baseStats[card.grade];\n    const multiplier = jobMultipliers[card.job];\n    return {\n      hp: Math.floor(base.hp * multiplier.hp),\n      atk: Math.floor(base.atk * multiplier.atk),\n      def: Math.floor(base.def * multiplier.def),\n      maxHp: Math.floor(base.hp * multiplier.hp)\n    };\n  };\n\n  // 데미지 계산 함수 추가 - 크리티컬과 회피 시스템 추가\n  const calculateDamage = (attacker, defender) => {\n    // 크리티컬 확률 (15%)\n    const isCritical = Math.random() < 0.15;\n    // 회피 확률 (10%)\n    const isEvaded = Math.random() < 0.10;\n    if (isEvaded) {\n      return {\n        damage: 0,\n        isCritical: false,\n        isEvaded: true\n      };\n    }\n    let damage = Math.max(1, attacker.atk - defender.def);\n    if (isCritical) {\n      damage = Math.floor(damage * 1.5);\n    }\n    return {\n      damage,\n      isCritical,\n      isEvaded: false\n    };\n  };\n\n  // 로그 메시지 생성 함수 수정\n  const createLogMessage = (attacker, target, damageInfo, isPlayerAttack) => {\n    if (damageInfo.isEvaded) {\n      return {\n        text: `${target.job}(${target.grade})가 ${attacker.job}(${attacker.grade})의 공격을 회피했습니다!`,\n        type: isPlayerAttack ? 'evaded-by-enemy' : 'evaded-by-player'\n      };\n    }\n    let message = `${attacker.job}(${attacker.grade})가 ${target.job}(${target.grade})에게 ${damageInfo.damage} 데미지를 입혔습니다!`;\n    if (damageInfo.isCritical) {\n      message = `크리티컬! ${message}`;\n    }\n    message += ` (${target.hp}/${target.maxHp})`;\n    return {\n      text: message,\n      type: isPlayerAttack ? damageInfo.isCritical ? 'critical-dealt' : 'damage-dealt' : damageInfo.isCritical ? 'critical-taken' : 'damage-taken'\n    };\n  };\n\n  // 전투 시작 함수 수정\n  const startBattle = async () => {\n    setIsBattling(true);\n    setBattleLog(['전투 시작!']);\n    const playerCards = playerParty.map(card => ({\n      ...card,\n      ...getCardStats(card),\n      isPlayer: true\n    }));\n    const enemyCards = enemyParty.map(card => ({\n      ...card,\n      ...getCardStats(card),\n      isPlayer: false\n    }));\n    let turn = 1;\n    while (playerCards.some(card => card.hp > 0) && enemyCards.some(card => card.hp > 0)) {\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      const attacker = turn % 2 === 1 ? playerCards : enemyCards;\n      const defender = turn % 2 === 1 ? enemyCards : playerCards;\n      for (let card of attacker.filter(c => c.hp > 0)) {\n        const target = defender.find(c => c.hp > 0);\n        if (target) {\n          const damage = Math.max(1, card.atk - target.def);\n          target.hp = Math.max(0, target.hp - damage);\n          setBattleLog(prev => [...prev, `${card.job}(${card.grade})가 ${target.job}(${target.grade})에게 ${damage} 데미지를 입혔습니다! (${target.hp}/${target.maxHp})`]);\n        }\n      }\n      setCurrentTurn(turn);\n      turn++;\n    }\n    const playerWon = playerCards.some(card => card.hp > 0);\n    setBattleLog(prev => [...prev, playerWon ? '플레이어의 승리!' : '적의 승리!']);\n    setIsBattling(false);\n  };\n\n  // ... rest of the component\n}\n_s(Battle, \"mpltea7vom6N9mYm3cZdMBjWO7Y=\");\n_c = Battle;\nvar _c;\n$RefreshReg$(_c, \"Battle\");","map":{"version":3,"names":["React","useState","Battle","playerParty","enemyParty","_s","battleLog","setBattleLog","currentTurn","setCurrentTurn","isBattling","setIsBattling","getCardStats","card","baseStats","SSR","hp","atk","def","SR","S","R","H","N","jobMultipliers","전사","마법사","궁수","도적","사제","base","grade","multiplier","job","Math","floor","maxHp","calculateDamage","attacker","defender","isCritical","random","isEvaded","damage","max","createLogMessage","target","damageInfo","isPlayerAttack","text","type","message","startBattle","playerCards","map","isPlayer","enemyCards","turn","some","Promise","resolve","setTimeout","filter","c","find","prev","playerWon","_c","$RefreshReg$"],"sources":["C:/JWH/vsc/study/reacts/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\r\n\r\n// ... existing code ...\r\n\r\nfunction Battle({ playerParty, enemyParty }) {\r\n  // ... existing state declarations ...\r\n\r\n  // State 선언 추가\r\n  const [battleLog, setBattleLog] = useState([]);\r\n  const [currentTurn, setCurrentTurn] = useState(1);\r\n  const [isBattling, setIsBattling] = useState(false);\r\n\r\n  // 카드의 스탯 계산 함수 수정 - 더 균형잡힌 스탯\r\n  const getCardStats = (card) => {\r\n    const baseStats = {\r\n      SSR: { hp: 100, atk: 20, def: 15 },\r\n      SR: { hp: 85, atk: 17, def: 13 },\r\n      S: { hp: 70, atk: 15, def: 11 },\r\n      R: { hp: 60, atk: 13, def: 9 },\r\n      H: { hp: 50, atk: 11, def: 7 },\r\n      N: { hp: 40, atk: 9, def: 5 }\r\n    };\r\n\r\n    const jobMultipliers = {\r\n      전사: { hp: 1.2, atk: 0.9, def: 1.3 },\r\n      마법사: { hp: 0.8, atk: 1.4, def: 0.7 },\r\n      궁수: { hp: 0.9, atk: 1.2, def: 0.8 },\r\n      도적: { hp: 0.7, atk: 1.3, def: 0.6 },\r\n      사제: { hp: 1.1, atk: 0.7, def: 1.0 }\r\n    };\r\n\r\n    const base = baseStats[card.grade];\r\n    const multiplier = jobMultipliers[card.job];\r\n\r\n    return {\r\n      hp: Math.floor(base.hp * multiplier.hp),\r\n      atk: Math.floor(base.atk * multiplier.atk),\r\n      def: Math.floor(base.def * multiplier.def),\r\n      maxHp: Math.floor(base.hp * multiplier.hp)\r\n    };\r\n  };\r\n\r\n  // 데미지 계산 함수 추가 - 크리티컬과 회피 시스템 추가\r\n  const calculateDamage = (attacker, defender) => {\r\n    // 크리티컬 확률 (15%)\r\n    const isCritical = Math.random() < 0.15;\r\n    // 회피 확률 (10%)\r\n    const isEvaded = Math.random() < 0.10;\r\n\r\n    if (isEvaded) {\r\n      return { damage: 0, isCritical: false, isEvaded: true };\r\n    }\r\n\r\n    let damage = Math.max(1, attacker.atk - defender.def);\r\n    if (isCritical) {\r\n      damage = Math.floor(damage * 1.5);\r\n    }\r\n\r\n    return { damage, isCritical, isEvaded: false };\r\n  };\r\n\r\n  // 로그 메시지 생성 함수 수정\r\n  const createLogMessage = (attacker, target, damageInfo, isPlayerAttack) => {\r\n    if (damageInfo.isEvaded) {\r\n      return {\r\n        text: `${target.job}(${target.grade})가 ${attacker.job}(${attacker.grade})의 공격을 회피했습니다!`,\r\n        type: isPlayerAttack ? 'evaded-by-enemy' : 'evaded-by-player'\r\n      };\r\n    }\r\n\r\n    let message = `${attacker.job}(${attacker.grade})가 ${target.job}(${target.grade})에게 ${damageInfo.damage} 데미지를 입혔습니다!`;\r\n    if (damageInfo.isCritical) {\r\n      message = `크리티컬! ${message}`;\r\n    }\r\n    message += ` (${target.hp}/${target.maxHp})`;\r\n\r\n    return {\r\n      text: message,\r\n      type: isPlayerAttack ? \r\n        (damageInfo.isCritical ? 'critical-dealt' : 'damage-dealt') : \r\n        (damageInfo.isCritical ? 'critical-taken' : 'damage-taken')\r\n    };\r\n  };\r\n\r\n  // 전투 시작 함수 수정\r\n  const startBattle = async () => {\r\n    setIsBattling(true);\r\n    setBattleLog(['전투 시작!']);\r\n\r\n    const playerCards = playerParty.map(card => ({\r\n      ...card,\r\n      ...getCardStats(card),\r\n      isPlayer: true\r\n    }));\r\n\r\n    const enemyCards = enemyParty.map(card => ({\r\n      ...card,\r\n      ...getCardStats(card),\r\n      isPlayer: false\r\n    }));\r\n\r\n    let turn = 1;\r\n    while (playerCards.some(card => card.hp > 0) && enemyCards.some(card => card.hp > 0)) {\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n      const attacker = turn % 2 === 1 ? playerCards : enemyCards;\r\n      const defender = turn % 2 === 1 ? enemyCards : playerCards;\r\n\r\n      for (let card of attacker.filter(c => c.hp > 0)) {\r\n        const target = defender.find(c => c.hp > 0);\r\n        if (target) {\r\n          const damage = Math.max(1, card.atk - target.def);\r\n          target.hp = Math.max(0, target.hp - damage);\r\n\r\n          setBattleLog(prev => [...prev, \r\n            `${card.job}(${card.grade})가 ${target.job}(${target.grade})에게 ${damage} 데미지를 입혔습니다! (${target.hp}/${target.maxHp})`\r\n          ]);\r\n        }\r\n      }\r\n\r\n      setCurrentTurn(turn);\r\n      turn++;\r\n    }\r\n\r\n    const playerWon = playerCards.some(card => card.hp > 0);\r\n    setBattleLog(prev => [...prev, \r\n      playerWon ? '플레이어의 승리!' : '적의 승리!'\r\n    ]);\r\n    setIsBattling(false);\r\n  };\r\n\r\n  // ... rest of the component\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}