<!-- ë°±ì—…:í˜ì´ì§•,ê²€ìƒ‰,í˜ì´ì§•ë¸”ëŸ­ì²˜ë¦¬ê¹Œì§€ í•œê±° -->
<!-- ì»¨íŠ¸ë¡¤ëŸ¬ ì ìš©í•˜ë ¤ê³  ì¼ë‹¨ ë°±ì—…ìœ¼ë¡œ ëºìŒ -->
<!-- ì»¨íŠ¸ë¡¤ëŸ¬ ì ìš© listì—ëŠ” ì¼ë‹¨ ê°€ì¥ ê¸°ì´ˆí˜•íƒœ ë¦¬ìŠ¤íŠ¸ë¡œ í•˜ë ¤ê³  í•¨(ì‰½ê²Œ) -->
<%@page import="com.peisia.jsp.board.Board"%>
<%@page import="java.util.ArrayList"%>
<%@page import="com.peisia.jsp.board.dto.Dto"%>
<%@page import="com.peisia.jsp.board.dao.DaoBoard"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
ê¸€ë²ˆí˜¸, ì œëª©, ì‘ì„±ì<hr>
<%
String pageNum=request.getParameter("page");
if(pageNum==null){
	pageNum="1";
}

DaoBoard dao=new DaoBoard();

int totalPage = 0;

ArrayList<Dto> posts = null;
String searchWord=request.getParameter("word");
if(searchWord==null||searchWord.equals("null")){	// case1. ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´
	posts=dao.list(pageNum);
	totalPage = dao.getPageCount();	//ì´ í˜ì´ì§€ ìˆ˜ êµ¬í•˜ê¸°
}else{					// case2. ê²€ìƒ‰ì–´ê°€ ìˆìœ¼ë©´
	posts=dao.selectlistSearch(searchWord,pageNum);
	totalPage = dao.getSearchPageCount(searchWord);	//ì´ í˜ì´ì§€ ìˆ˜ êµ¬í•˜ê¸°
}

for(int i=0;i<posts.size();i=i+1){
%>

<%=posts.get(i).no%>
<a href="/board/read?no=<%=posts.get(i).no%>"><%=posts.get(i).title%></a>
<%=posts.get(i).id%>
<hr>
<%
}
%>
<a href="write.jsp">ì“°ê¸°</a>


<hr><hr>
<%
	int nPageNum = Integer.parseInt(pageNum);	//ê³„ì‚°ì„ ìœ„í•´ ë³€í™˜.

	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 1/9}.ë¸”ëŸ­ ì´ ê°¯ìˆ˜ êµ¬í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	//ë¸”ëŸ­ì´ë€? ex. [1][2][3][4][5] ... [6][7][8][9][10] << ì´ë ‡ê²Œ ê²Œì‹œíŒ í•˜ë‹¨ì— í˜ì´ì§€ ë¦¬ìŠ¤íŠ¸ë“¤ì´ ë¬¶ì¸ ë‹¨ìœ„(1~5:1ë¸”ëŸ­, 6~10:2ë¸”ëŸ­)
	//ë¸”ëŸ­ ì´ ê°¯ìˆ˜ = í˜ì´ì§€ ìˆ˜ / ë¸”ëŸ­ ë‹¹ í˜ì´ì§€ ìˆ˜ << ê²°ê³¼ì— ì˜¬ë¦¼ ì²˜ë¦¬
	int totalBlock = (int)Math.ceil((double) totalPage / Board.PAGE_LINK_AMOUNT);	
	
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 2/9}.í˜„ì¬ ë¸”ëŸ­ ë²ˆí˜¸ êµ¬í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	//í˜„ì¬ ë¸”ëŸ­ ë²ˆí˜¸ = í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸ / ë¸”ëŸ­ ë‹¹ í˜ì´ì§€ ìˆ˜ << ê²°ê³¼ì— ì˜¬ë¦¼ ì²˜ë¦¬
	int currentBlockNo = (int)Math.ceil((double)nPageNum / Board.PAGE_LINK_AMOUNT);

	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 3/9}.ë¸”ëŸ­ ì‹œì‘ í˜ì´ì§€ ë²ˆí˜¸ êµ¬í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	//ë¸”ëŸ­ ì‹œì‘ í˜ì´ì§€ ë²ˆí˜¸ = (í˜„ì¬ ë¸”ëŸ­ ë²ˆí˜¸ - 1) * ë¸”ëŸ­ ë‹¹ í˜ì´ì§€ ìˆ˜ + 1
	int	blockStartNo = (currentBlockNo - 1) * Board.PAGE_LINK_AMOUNT + 1;

	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 4/9}.ë¸”ëŸ­ í˜ì´ì§€ ë ë²ˆí˜¸ êµ¬í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	//ë¸”ëŸ­ í˜ì´ì§€ ë ë²ˆí˜¸ = í˜„ì¬ ë¸”ëŸ­ ë²ˆí˜¸ * ë¸”ëŸ­ ë‹¹ í˜ì´ì§€ ìˆ˜
	int blockEndNo = currentBlockNo * Board.PAGE_LINK_AMOUNT;
	//ë§Œì•½ ë¸”ëŸ­ ë§ˆì§€ë§‰ í˜ì´ì§€ ë²ˆí˜¸ê°€ ì „ì²´ í˜ì´ì§€ ë§ˆì§€ë§‰ ë²ˆí˜¸ë³´ë‹¤ í°ê²½ìš°ì—ëŠ” ë¸”ëŸ­ ë§ˆì§€ë§‰ í˜ì´ì§€ë²ˆí˜¸ë¥¼ í˜ì´ì§€ ë§ˆì§€ë§‰ ë²ˆí˜¸ë¡œ ì €ì¥í•˜ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ í•˜ê¸°
	if(blockEndNo > totalPage) {
		blockEndNo = totalPage;
	}
	
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 5/9}.ì´ì „ ë‹¤ìŒ ì²˜ë¦¬ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸ 
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸: í˜„ì¬ ë¸”ëŸ­ì—ì„œ ì´ì „/ë‹¤ìŒì„ ëˆŒë €ì„ ë•Œ í˜„ì¬ í˜ì´ì§€ ê°’ì„ ë³€ê²½í•  ë•Œ ë„£ì„ ê°’ì„ ì¼ë‹¨ ì´ˆê¸°í™”í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	//ì´ì „ ë‹¤ìŒì´ë€? ex.    <ì´ì „ [1][2][3][4][5] ë‹¤ìŒ> <<ìš”ëŸ°ê±°
	int prevPage = 0;
	int nextPage = 0;
	
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 6/9}.ì´ì „ ë‹¤ìŒ ì²˜ë¦¬ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸ 
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸: í˜„ì¬ ë¸”ëŸ­ì—ì„œ ì´ì „/ë‹¤ìŒì´ ê°€ëŠ¥í•œì§€ ê³„ì‚°í•˜ê³  ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì €ì¥í•´ë‘ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	boolean hasPrev = true;	//ì´ì „ ë¸”ëŸ­ ê°€ê¸° ê°€ëŠ¥ ì—¬ë¶€ ì €ì¥ê°’ ì´ˆê¸°í™”.
	if(currentBlockNo == 1){	//í˜„ì¬ ë¸”ëŸ­ì´ 1ë²ˆ ë¸”ëŸ­ì´ë©´
		hasPrev = false;		//ì´ì „ ë¸”ëŸ­ ê°€ê¸° ë¶ˆê°€ëŠ¥
	} else {					//í˜„ì¬ ë¸”ëŸ­ì´ 1ë²ˆ ë¸”ëŸ­ì´ ì•„ë‹ˆë©´
		hasPrev = true;			//ì´ì „ ë¸”ëŸ­ ê°€ê¸° ê°€ëŠ¥
		//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸: ì´ì „ ë¸”ëŸ­ ì´ë™ ì‹œ ëª‡ í˜ì´ì§€ë¡œ ì´ë™í• ì§€ ì •í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
		//ì´ì „ ë¸”ëŸ­ì˜ ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™í•˜ê²Œ í•˜ë©´ ë¨(ë³´í†µ ì´ë ‡ê²Œ ì²˜ë¦¬í•˜ë‹ˆê¹Œ)
		//ê³µì‹ : (í˜„ì¬ ë¸”ëŸ­ ë²ˆí˜¸ - 1) * ë¸”ëŸ­ ë‹¹ í˜ì´ì§€ ìˆ˜
		prevPage = (currentBlockNo - 1 ) * Board.PAGE_LINK_AMOUNT;
	}
	
	boolean hasNext = true;	//ë‹¤ìŒ ë¸”ëŸ­ ê°€ê¸° ê°€ëŠ¥ ì—¬ë¶€ ì €ì¥ê°’ ì´ˆê¸°í™”.
	if(currentBlockNo < totalBlock ){	//í˜„ì¬ ë¸”ëŸ­ì´ ë§ˆì§€ë§‰ ë¸”ëŸ­ë³´ë‹¤ ì‘ìœ¼ë©´
		hasNext = true;					//ë‹¤ìŒ ë¸”ëŸ­ ê°€ê¸° ê°€ëŠ¥
		//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸: ë‹¤ìŒ ë¸”ëŸ­ ì´ë™ ì‹œ ëª‡ í˜ì´ì§€ë¡œ ì´ë™í• ì§€ ì •í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
		//ë‹¤ìŒ ë¸”ëŸ­ì˜ ì²« í˜ì´ì§€ë¡œ ì´ë™í•˜ê²Œ í•˜ë©´ ë¨(ë³´í†µ ì´ë ‡ê²Œ ì²˜ë¦¬í•˜ë‹ˆê¹Œ)
		//ê³µì‹ : í˜„ì¬ ë¸”ëŸ­ ë²ˆí˜¸ * ë¸”ëŸ­ ë‹¹ í˜ì´ì§€ ìˆ˜ + 1
		nextPage = currentBlockNo * Board.PAGE_LINK_AMOUNT + 1;		
	} else {							//í˜„ì¬ ë¸”ëŸ­ì´ ë§ˆì§€ë§‰ ë¸”ëŸ­ë³´ë‹¤ ê°™ê±°ë‚˜ í¬ë©´(í°ê°’ì´ ì˜¤ë©´ ì•ˆë˜ê² ì§€ë§Œ)
		hasNext = false;				//ë‹¤ìŒ ë¸”ëŸ­ ê°€ê¸° ë¶ˆê°€ëŠ¥
	}

	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 7/9}.ì´ì „ ë‹¤ìŒ ì²˜ë¦¬ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸: ì´ì „ ë¸”ëŸ­ ì´ë™ì´ ê°€ëŠ¥í•˜ë©´ ë¯¸ë¦¬ ê³„ì‚°í•œ ì´ì „ ë¸”ë¡ ì´ë™ ì‹œ ì´ë™ í•  í˜ì´ì§€ë²ˆí˜¸ë¥¼ ë‘í¬ì— ì „ë‹¬í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	if(hasPrev){
		if(searchWord==null){	// <1>ì¼ë°˜ ë¦¬ìŠ¤íŠ¸
%>
			<a href="list.jsp?page=<%=prevPage%>">ğŸ¿ï¸ì´ì „ë¸”ëŸ­ê°€ê¸°ğŸ¿ï¸</a>
<%				
		} else {				// <2>ê²€ìƒ‰ì–´ë¡œ ê²€ìƒ‰í•œ ë¦¬ìŠ¤íŠ¸
%>				
			<a href="list.jsp?page=<%=prevPage%>&word=<%=searchWord%>">ğŸ¿ï¸ì´ì „ë¸”ëŸ­ê°€ê¸°ğŸ¿ï¸</a>
<%				
		}		
	}
	
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 8/9}.ê¸°ì¡´ì˜ ì œí•œ ì—†ë˜ í˜ì´ì§€ë¦¬ìŠ¤íŠ¸ ë‚˜ì—´ì„ ex.[1][2][3].....[n] ë¸”ëŸ­ ì ìš©í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸í˜„ì¬ ë¸”ëŸ­ì˜ í˜ì´ì§€ ì‹œì‘ë²ˆí˜¸ì™€ ëë²ˆí˜¸ë¥¼ ì´ìš©í•˜ì—¬ ë°˜ë³µë¬¸ì˜ ì‹œì‘ê°’ ëê°’ìœ¼ë¡œ í•˜ê³  ì´ ê°’ì„ í˜ì´ì§€ ë²ˆí˜¸ë¡œ ì¶œë ¥í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸
	//for(int i=1;i<=pageMaxNumber;i++){  			<< ì´ì „ ë°˜ë³µë¬¸ì„
	for(int i=blockStartNo;i<=blockEndNo;i++){	// 	<< ì´ë ‡ê²Œ ë°”ê¿ˆ
		if(nPageNum == i){
%>
			ğŸŒ°<%=i %>ğŸŒ°
<%
		} else {
			//<ê²€ìƒ‰ì²˜ë¦¬ 5/5>.í•˜ë‹¨ í˜ì´ì§€ ë§í¬ ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ ë° ë§í¬ì²˜ë¦¬ë¥¼ ê²€ìƒ‰ëª¨ë“œ/ì¼ë°˜ëª¨ë“œ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬			
			if(searchWord==null){	// <1>ì¼ë°˜ ë¦¬ìŠ¤íŠ¸
%>				
			ğŸŒ°<a href="list.jsp?page=<%=i %>"><%=i %></a>ğŸŒ°
<%				
			} else {				// <2>ê²€ìƒ‰ì–´ë¡œ ê²€ìƒ‰í•œ ë¦¬ìŠ¤íŠ¸
				//*ì¤‘ìš”* í•œê¸€ ê²€ìƒ‰ì–´ë¥¼ ì „ë‹¬í•  ë•ŒëŠ” urlì¸ì½”ë”©ì„ í•´ì¤˜ì•¼í•¨. ì˜ì–´ëŠ” ê´œì°®ìŒ. ê·¸ë˜ë„ ë‹¤ í•´ì£¼ê³ ..
				String urlEncodedSearchWord = java.net.URLEncoder.encode(searchWord);				
%>				
				ğŸŒ°<a href="list.jsp?page=<%=i %>&word=<%=urlEncodedSearchWord%>"><%=i %></a>ğŸŒ°
<%				
			}			
		}
	}
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸{ë¸”ëŸ­ ì²˜ë¦¬ - 9/9}.ì´ì „ ë‹¤ìŒ ì²˜ë¦¬ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸
	//ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸: ë‹¤ìŒ ë¸”ëŸ­ ì´ë™ì´ ê°€ëŠ¥í•˜ë©´ ë¯¸ë¦¬ ê³„ì‚°í•œ ì´ì „ ë¸”ë¡ ì´ë™ ì‹œ ì´ë™ í•  í˜ì´ì§€ë²ˆí˜¸ë¥¼ ë‘í¬ì— ì „ë‹¬í•˜ê¸°ğŸ¿ï¸ğŸ¿ï¸ğŸ¿ï¸//
	if(hasNext){
			if(searchWord==null){	// <1>ì¼ë°˜ ë¦¬ìŠ¤íŠ¸
%>
				<a href="list.jsp?page=<%=nextPage%>">ğŸ¿ï¸ë‹¤ìŒë¸”ëŸ­ê°€ê¸°ğŸ¿ï¸</a>
<%				
			} else {				// <2>ê²€ìƒ‰ì–´ë¡œ ê²€ìƒ‰í•œ ë¦¬ìŠ¤íŠ¸
%>				
				<a href="list.jsp?page=<%=nextPage%>&word=<%=searchWord%>">ğŸ¿ï¸ë‹¤ìŒë¸”ëŸ­ê°€ê¸°ğŸ¿ï¸</a>
				
<%				
			}			
	}
%>

<form action="list.jsp">
	<input name="word">
	<input type="submit" value="ê²€ìƒ‰">
</form>

<a href="list.jsp">listë¡œ</a>

</body>
</html>